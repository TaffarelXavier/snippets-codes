function selectOptionByValue(selectElement,value){for(var options=selectElement.options,i=0,optionsLength=options.length;i<optionsLength;i++)if(options[i].value==value)return selectElement.selectedIndex=i,!0;return!1}function funcoesNota(){$(".editar-nota").click((function(){var{note_id:note_id,note_title:note_title,note_description:note_description,note_tags:note_tags,note_type_language:note_type_language,category_id:category_id,type_language:type_language}=JSON.parse($(this).attr("data-nota")),categoriaElement=document.getElementById("gd-gategory"),linguagemFormatacaoElement=document.getElementById("gd-language"),tagsElement=document.getElementById("gd-select-tags"),tags=document.getElementById(`tags_${note_id}`).value;try{tags=JSON.parse(tags).length>0?JSON.parse(tags):""}catch(error){console.error("Erro Tx1: ",error)}tags.length>0&&($(tagsElement).html(""),tags.map(({tag_id:tag_id,tag_name:tag_name})=>{$(tagsElement).append(`<option value='${tag_id}' selected="selected">${tag_name}</option>`)})),selectOptionByValue(categoriaElement,category_id),selectOptionByValue(linguagemFormatacaoElement,type_language),$("#modalEditarNota").modal("show"),$("#gd-title").val(note_title),$("#gd-description").val(note_description),$("#gd-tags").val(note_tags);var editor=ace.edit(document.getElementById(`note_${note_id}`));$("#gd-get-note").html(escapeHtml(editor.getValue())).addClass(note_type_language),$("#nota-id").val(note_id),$("pre code").each((function(i,e){hljs.highlightBlock(e)}))})),$(".copiar").each((function(index,element){$(this).click((function(ev){let note_id=$(this).attr("data-id");var editor=ace.edit(document.getElementById(`note_${note_id}`)),beautify;ace.require("ace/ext/beautify").beautify(editor.session);var options={content:"Código copiado com sucesso!",style:"toast",timeout:2e3};$.snackbar(options)}))})),$(".editor").each((function(i,el){var _this=$(this);let{lang_name:lang_name}=JSON.parse(_this.attr("data-note"));var editor=ace.edit(el,{mode:"ace/mode/"+lang_name,maxLines:800,wrap:!0,autoScrollEditorIntoView:!0,minLines:1});el.style.fontSize="16px",editor.setTheme("ace/theme/dracula"),editor.session.setTabSize(4),editor.resize(),editor.setOptions({autoScrollEditorIntoView:!0,copyWithEmptySelection:!0})})),$(".open-code").click((function(){var _this=$(this);let{note_id:note_id}=JSON.parse(_this.attr("data-nota"))})),$(".excluir-nota").click((function(){let note_id=parseInt($(this).attr("data-nota-id")),options={type:"question",buttons:["Não","Sim"],title:"Deseja realmente excluir esta nota?",message:"Esta operação não poderá ser revertida.",detail:"Algum detalhe aqui",defaultId:0,cancelId:-1};remote.dialog.showMessageBox(win,options,response=>{1==response&&($(`#note_card_${note_id}`).remove(),carregarCategorias())})})),$(".tag").click((function(ev){let keyword=ev.target.innerText;$("#input-pesquisar-tag").val(keyword),pesquisarPorTag(keyword)}))}function pesquisarPorTag(keyword){if(keyword.length>0){var tags=$(".tag");$(".notas").removeClass("d-flex").attr("hidden",!0).hide();for(var k=0;k<tags.size();k++)if(tags[k].innerText.toUpperCase()==keyword.toUpperCase()){var note_id=tags[k].getAttribute("data-note-id");$("#note_card_"+note_id).removeAttr("hidden").show()}}else $(".notas").removeAttr("hidden").show()}function getNotesByCategoryId(category_id,callback){var myInit={method:"GET",mode:"cors",cache:"default"};fetch(config[INDEX].baseApiRestUrl+"/notes-por-category-id/"+parseInt(category_id),myInit).then((function(response){200===response.status?response.json().then((function(result){callback(result)})):console.warn("Looks like there was a problem. Status Code: "+response.status)}))}function loadTodosSnippets(){fetch(config[INDEX].baseApiRestUrl+"/notes",{method:"GET"}).then(response=>{200!==response.status||response.json().then(result=>{let content="";result.map(nota=>{content+=notas(nota,[])}),$("#get-notes").html(content),funcoesNota(),$("#get-notes").text().toString().length>0&&$("#esqueleto").attr("hidden",!0)})})}function carregarCategorias(){var myInit={method:"GET",mode:"cors",cache:"default"};fetch(config[INDEX].baseApiRestUrl+"/categories",myInit).then((function(response){200===response.status?response.json().then((function(result){var rows=document.getElementById("category");rows.innerHTML="",result.sort((a,b)=>b.total-a.total),result.map(row=>{let{category_id:category_id,category_name:category_name,category_icon:category_icon}=row;var item=document.createElement("li");item.onclick=function(ev){return $("#painel-termo-filtrado").removeAttr("hidden"),window.location.href="#painel-termo-filtrado",$("#termo-filtrado").html("TERMO FILTRADO: "+this.innerText.trim().toUpperCase()),$("#esqueleto").removeAttr("hidden"),$(".list-group-item").removeClass("list-group-item-action list-group-item-success"),$(this).addClass("list-group-item-action list-group-item-success","disabled"),getNotesByCategoryId(category_id,(function(res){$("#get-notes").html("");let content="";res.map(nota=>{content+=notas(nota,[])}),$("#get-notes").html(content),funcoesNota(),res.length>0&&$("#esqueleto").attr("hidden",!0)})),!1};const ICON_PADRAO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAAAAACpleexAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfjDBMUJR7SizDUAAAAJElEQVQ4y2M4QyRgGFU4qnBkKbxw8eLNixcHtxtHFY4qHAoKAWtc+2KAiEgvAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTEyLTIwVDA1OjM3OjMwKzA5OjAwhGs2fQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0xMi0yMFQwNTozNzozMCswOTowMPU2jsEAAAAASUVORK5CYII=";$(item).addClass("list-group-item justify-content-between").css({borderBottom:"1px dashed #ccc",padding:"0px !important"}).html(`<span class="categoria-nome">\n              <img style="margin:0;position: relative;top:-1px; width:40px;height: 40px;"\n               src="${ICON_PADRAO}" alt="${category_icon.trim()}" data-src='${null!=category_icon?category_icon.trim():ICON_PADRAO}' class="lazy" /> \x3c!----\x3e\n              ${category_name.toUpperCase()}</span>\n   <span class='badge badge-primary badge-pill' style="float:right;position:relative;top:-10px;margin:0">${row.total}</span>`).attr("data-category",JSON.stringify(row)).attr("title",category_name.toUpperCase()),rows.appendChild(item),setTimeout((function(){var lazyImages=[].slice.call(document.querySelectorAll("img.lazy"));if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){let lazyImageObserver=new IntersectionObserver((function(entries,observer){entries.forEach((function(entry){if(entry.isIntersecting){let lazyImage=entry.target;lazyImage.src=lazyImage.dataset.src,lazyImage.classList.remove("lazy"),lazyImageObserver.unobserve(lazyImage)}}))}));lazyImages.forEach((function(lazyImage){lazyImageObserver.observe(lazyImage)}))}}),500)})})):console.warn("Looks like there was a problem. Status Code: "+response.status)})).catch((function(err){console.error("Fetch Error :-S",err)}))}function mergeArrayWithDiff(arrayA,arrayB){var result;return[...arrayA,...arrayB].reduce((acc,item)=>{let found=acc.find(x=>x.category_name===item.category_name);return found?found.count+=item.count:acc.push(Object.assign({},item)),acc},[])}function carregarTodasCategoria(){setTimeout(()=>{var rows=document.getElementById("gd-get-categories"),arrayA=Category.getCategorieWithCountNotes(),arrayB=Category.all(),result;mergeArrayWithDiff(arrayA,arrayB=arrayB.map(el=>(el.count=0,el))).map(category=>{var cat=Category.getCategorieWithCountNotes(),item=document.createElement("li");$(item).addClass("mdc-list-item mdc-ripple-upgraded").css({borderBottom:"1px dashed #ccc",padding:"0px !important"}).html(`<span class="mdc-list-item__text">${category.category_name.toUpperCase()}[${category.count}]</span>\n          \x3c!--<span class="mdc-list-item__meta material-icons" aria-hidden="true" data-category-id='${category.category_id}'>delete</span>--\x3e\n          <span class="mdc-list-item__meta material-icons remove-category"\n           aria-hidden="true" data-category='${JSON.stringify(category)}'>delete</span>\n        `).attr("id","category__"+category.category_id).attr("data-category",JSON.stringify(category)).attr("title",category.category_name.toUpperCase()),rows.appendChild(item)}),$(".remove-category").click((function(){}))},1e3)}$(document).ready((function(){function getAllNotes(){let rows=sqlite.run("SELECT * FROM notes AS t1 JOIN languages AS t2\n    ON t1.note_type_language = t2.lang_id ORDER BY t1.created_at DESC;");return sqlite.close(),rows}loadTodosSnippets(),$("#abrir-modal-criador-categoria").click((function(){setTimeout((function(){$("#category-name").focus().select()}),500)})),$("#categoria").keyup((function(){let _value=$(this);var keyword=removeSinaisDiacriticos(_value.val().toLowerCase());let categories=document.getElementById("category").childNodes;for(let k=0;k<categories.length;k++){var textoArray;removeSinaisDiacriticos(categories[k].title.toLowerCase()).includes(keyword)?$(categories[k]).removeAttr("hidden").show():$(categories[k]).removeClass("d-flex").attr("hidden",!0).hide()}$(".categoria-nome").unmark({done:function(){$(".categoria-nome").mark(keyword)}})})),$("#input-pesquisar-tag").on("input",ev=>{var keyword;pesquisarPorTag(ev.target.value)}),$("#input-pesquisar-geral").on("input",(function(){var _this=$(this),textoPesquisado=removeSinaisDiacriticos(_this.val().toLowerCase()),cardTitle=document.getElementsByClassName("card-description");if($(".note-title").each((i,el)=>{var textoElemento=removeSinaisDiacriticos(el.innerText.toLowerCase()),description=removeSinaisDiacriticos(cardTitle[i].innerText.toLowerCase()),nota_id=parseInt($(el).attr("data-note-id"));textoElemento.includes(textoPesquisado)||description.includes(textoPesquisado)?$("#note_card_"+nota_id).removeAttr("hidden").show():$("#note_card_"+nota_id).removeClass("d-flex").attr("hidden",!0).hide()}),textoPesquisado.length>0){var keyword=textoPesquisado;$(".note-title, .card-description").unmark({done:function(){$(".note-title, .card-description").mark(keyword)}})}else $(".note-title, .card-description").unmark()})),$("body").append(modalCategory("Criar nova categoria","exampleModal","idButton1"),modalCriarNota("Criar nova nota","modalCriarNota","buttonCriarNota"),modalEditarNota("Editar Nota","modalEditarNota","btnAlterarNota")),$("#categories_id").change((function(ev){let linguagem=$(this).find("option:selected").text().toUpperCase();var languages,index=[].slice.call(document.getElementById("languages")).findIndex(fruit=>fruit.label.toUpperCase()==linguagem);document.getElementById("languages").selectedIndex=index})),funcSelect2("#select-tags"),funcSelect2("#gd-select-tags"),$("#modalCriarNota").on("show.bs.modal",(function(event){setTimeout(()=>{$("#note-title").focus().select()},500)})),$("#form-category").submit((function(ev){})),$("#form-editar-nota").submit((function(ev){ev.preventDefault();let nota_id=document.getElementById("nota-id").value,title=this.elements["gd-title"].value,description=this.elements["gd-description"].value,tagsElement=document.getElementById("gd-select-tags"),code=document.getElementById("gd-get-note"),category=document.getElementById("gd-gategory"),language=document.getElementById("gd-language");var obj_note_id=nota_id,obj_note_title=title,obj_note_description=description,obj_note_code=code.innerText,obj_note_category_id=category[category.selectedIndex].value,obj_note_type_language=language[language.selectedIndex].value;return alert("Nota editaca com sucesso!"),!1})),$("#formSave").submit((function(ev){ev.preventDefault();let _this=this,title=this.elements.title.value,description=this.elements.description.value,code=this.elements.code.value,category=this.elements.category[this.elements.category.selectedIndex],language=this.elements["formatacao-language"][this.elements["formatacao-language"].selectedIndex];var arrInserTags=[];let tags=$("#select-tags").select2("data").map((function(el){}));var obj_note_title=title,obj_note_description=description,obj_note_code=code,obj_note_category_id=category.value,obj_note_type_language=language.value,formData=new FormData(document.getElementById("formSave"));return fetch(config[INDEX].baseApiRestUrl+"/notes",{method:"POST",body:formData}).then(response=>{}),this.reset(),alert("Nota criada com sucesso!"),carregarCategorias(),!1}));let conteudo="";funcoesNota(),carregarCategorias(),$("#tela-inicial").click((function(){$("#get-notes").html(""),funcoesNota()}))}));