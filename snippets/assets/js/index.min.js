function selectOptionByValue(e,t){for(var a=e.options,o=0,n=a.length;o<n;o++)if(a[o].value==t)return e.selectedIndex=o,!0;return!1}function funcoesNota(){$(".editar-nota").click(function(){var{note_id:e,note_title:t,note_description:a,note_tags:o,note_type_language:n,category_id:i,type_language:r}=JSON.parse($(this).attr("data-nota")),s=document.getElementById("gd-gategory"),c=document.getElementById("gd-language"),l=document.getElementById("gd-select-tags"),d=document.getElementById(`tags_${e}`).value;try{d=JSON.parse(d).length>0?JSON.parse(d):""}catch(e){console.error("Erro Tx1: ",e)}d.length>0&&($(l).html(""),d.map(({tag_id:e,tag_name:t})=>{$(l).append(`<option value='${e}' selected="selected">${t}</option>`)})),selectOptionByValue(s,i),selectOptionByValue(c,r),$("#modalEditarNota").modal("show"),$("#gd-title").val(t),$("#gd-description").val(a),$("#gd-tags").val(o);var g=ace.edit(document.getElementById(`note_${e}`));$("#gd-get-note").html(escapeHtml(g.getValue())).addClass(n),$("#nota-id").val(e),$("pre code").each(function(e,t){hljs.highlightBlock(t)})}),$(".copiar").each(function(e,t){$(this).click(function(e){let t=$(this).attr("data-id");var a=ace.edit(document.getElementById(`note_${t}`)),o=ace.require("ace/ext/beautify");o.beautify(a.session);var n={content:"Código copiado com sucesso!",style:"toast",timeout:2e3};$.snackbar(n)})}),$(".editor").each(function(e,t){var a=$(this);let{lang_name:o}=JSON.parse(a.attr("data-note"));var n=ace.edit(t,{mode:"ace/mode/"+o,maxLines:800,wrap:!0,autoScrollEditorIntoView:!0,minLines:1});t.style.fontSize="16px",n.setTheme("ace/theme/dracula"),n.session.setTabSize(4),n.resize(),n.setOptions({autoScrollEditorIntoView:!0,copyWithEmptySelection:!0})}),$(".open-code").click(function(){var e=$(this);let{note_id:t}=JSON.parse(e.attr("data-nota"))}),$(".excluir-nota").click(function(){let e=parseInt($(this).attr("data-nota-id")),t={type:"question",buttons:["Não","Sim"],title:"Deseja realmente excluir esta nota?",message:"Esta operação não poderá ser revertida.",detail:"Algum detalhe aqui",defaultId:0,cancelId:-1};remote.dialog.showMessageBox(win,t,t=>{1==t&&($(`#note_card_${e}`).remove(),console.log(Note.delete(e)),carregarCategorias())})}),$(".tag").click(function(e){let t=e.target.innerText;$("#input-pesquisar-tag").val(t),pesquisarPorTag(t)})}function pesquisarPorTag(e){if(e.length>0){var t=$(".tag");$(".notas").removeClass("d-flex").attr("hidden",!0).hide();for(var a=0;a<t.size();a++)if(t[a].innerText.toUpperCase()==e.toUpperCase()){var o=t[a].getAttribute("data-note-id");$("#note_card_"+o).removeAttr("hidden").show()}}else $(".notas").removeAttr("hidden").show()}function getNotesByCategoryId(e,t){var a={method:"GET",mode:"cors",cache:"default"};fetch(config[INDEX].baseApiRestUrl+"/notes-por-category-id/"+parseInt(e),a).then(function(e){200===e.status?e.json().then(function(e){t(e)}):console.log("Looks like there was a problem. Status Code: "+e.status)})}function carregarCategorias(){var e={method:"GET",mode:"cors",cache:"default"};fetch(config[INDEX].baseApiRestUrl+"/categories",e).then(function(e){200===e.status?e.json().then(function(e){var t=document.getElementById("category");t.innerHTML="",e.map(e=>{let{category_id:a,category_name:o,category_icon:n}=e;var i=document.createElement("li");i.onclick=function(){return $("#esqueleto").removeAttr("hidden"),$(".list-group-item").removeClass("list-group-item-action list-group-item-success"),$(this).addClass("list-group-item-action list-group-item-success","disabled"),getNotesByCategoryId(a,function(e){$("#get-notes").html("");let t="";e.map(e=>{t+=notas(e,[])}),$("#get-notes").html(t),funcoesNota(),e.length>0&&$("#esqueleto").attr("hidden",!0)}),!1};const r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAAAAACpleexAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfjDBMUJR7SizDUAAAAJElEQVQ4y2M4QyRgGFU4qnBkKbxw8eLNixcHtxtHFY4qHAoKAWtc+2KAiEgvAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTEyLTIwVDA1OjM3OjMwKzA5OjAwhGs2fQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0xMi0yMFQwNTozNzozMCswOTowMPU2jsEAAAAASUVORK5CYII=";$(i).addClass("list-group-item justify-content-between").css({borderBottom:"1px dashed #ccc",padding:"0px !important"}).html(`<span class="categoria-nome">\n              <img style="margin:0;position: relative;top:-1px; width:40px;height: 40px;"\n               src="${r}" data-src='${null!=n?n.trim():r}' class="lazy" /> <!---->\n              ${o.toUpperCase()}</span>\n   <span class='badge badge-primary badge-pill' style="float:right;position:relative;top:-10px;margin:0">${e.total}</span>`).attr("data-category",JSON.stringify(e)).attr("title",o.toUpperCase()),t.appendChild(i),setTimeout(function(){var e=[].slice.call(document.querySelectorAll("img.lazy"));if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){let t=new IntersectionObserver(function(e,a){e.forEach(function(e){if(e.isIntersecting){let a=e.target;a.src=a.dataset.src,a.classList.remove("lazy"),t.unobserve(a)}})});e.forEach(function(e){t.observe(e)})}},500)})}):console.log("Looks like there was a problem. Status Code: "+e.status)}).catch(function(e){console.log("Fetch Error :-S",e)})}function mergeArrayWithDiff(e,t){var a=[...e,...t].reduce((e,t)=>{let a=e.find(e=>e.category_name===t.category_name);return a?a.count+=t.count:e.push(Object.assign({},t)),e},[]);return a}function carregarTodasCategoria(){setTimeout(()=>{var e=document.getElementById("gd-get-categories"),t=Category.getCategorieWithCountNotes(),a=Category.all();a=a.map(e=>(e.count=0,e));var o=mergeArrayWithDiff(t,a);o.map(t=>{Category.getCategorieWithCountNotes();var a=document.createElement("li");$(a).addClass("mdc-list-item mdc-ripple-upgraded").css({borderBottom:"1px dashed #ccc",padding:"0px !important"}).html(`<span class="mdc-list-item__text">${t.category_name.toUpperCase()}[${t.count}]</span>\n          <!--<span class="mdc-list-item__meta material-icons" aria-hidden="true" data-category-id='${t.category_id}'>delete</span>-->\n          <span class="mdc-list-item__meta material-icons remove-category"\n           aria-hidden="true" data-category='${JSON.stringify(t)}'>delete</span>\n        `).attr("id","category__"+t.category_id).attr("data-category",JSON.stringify(t)).attr("title",t.category_name.toUpperCase()),e.appendChild(a)}),$(".remove-category").click(function(){var{category_id:e,count:t}=JSON.parse($(this).attr("data-category"));let a={type:"question",buttons:["Não","Sim"],title:"Deseja realmente excluir esta categoria?",message:"Esta operação não poderá ser revertida.",detail:"Algum detalhe aqui",defaultId:0,cancelId:-1};remote.dialog.showMessageBox(win,a,a=>{1==a&&(t>0?alert("Operação não permitida, porque há notas relacionadas a esta categoria."):(Category.delete(e),$(`#category__${e}`).remove(),carregarCategorias()))})})},1e3)}$(document).ready(function(){$("#abrir-modal-criador-categoria").click(function(){setTimeout(function(){$("#category-name").focus().select()},500)}),$("#categoria").keyup(function(){let e=$(this);var t=removeSinaisDiacriticos(e.val().toLowerCase());let a=document.getElementById("category").childNodes;for(let e=0;e<a.length;e++){var o=removeSinaisDiacriticos(a[e].title.toLowerCase());o.includes(t)?$(a[e]).removeAttr("hidden").show():$(a[e]).removeClass("d-flex").attr("hidden",!0).hide()}$(".categoria-nome").unmark({done:function(){$(".categoria-nome").mark(t)}})}),$("#input-pesquisar-tag").on("input",e=>{var t=e.target.value;pesquisarPorTag(t)}),$("#input-pesquisar-geral").on("input",function(){var e=$(this),t=removeSinaisDiacriticos(e.val().toLowerCase()),a=document.getElementsByClassName("card-description");if($(".note-title").each((e,o)=>{var n=removeSinaisDiacriticos(o.innerText.toLowerCase()),i=removeSinaisDiacriticos(a[e].innerText.toLowerCase()),r=parseInt($(o).attr("data-note-id"));n.includes(t)||i.includes(t)?$("#note_card_"+r).removeAttr("hidden").show():$("#note_card_"+r).removeClass("d-flex").attr("hidden",!0).hide()}),t.length>0){var o=t;$(".note-title, .card-description").unmark({done:function(){$(".note-title, .card-description").mark(o)}})}else $(".note-title, .card-description").unmark()}),$("body").append(modalCategory("Criar nova categoria","exampleModal","idButton1"),modalCriarNota("Criar nova nota","modalCriarNota","buttonCriarNota"),modalEditarNota("Editar Nota","modalEditarNota","btnAlterarNota")),$("#abrir-dev-tools").click(function(){console.log("#abrir-dev-tools foi clicado")}),funcSelect2("#select-tags"),funcSelect2("#gd-select-tags"),$("#modalCriarNota").on("show.bs.modal",function(e){setTimeout(()=>{$("#note-title").focus().select()},500)}),$("#idButton1").click(function(){let e=$("#category-name").val().trim();if(""!=e){var t=Category.create(e.toUpperCase());alert("Categoria criada com sucesso!");var a=document.getElementsByName("languages");$(a).append(`<option value='${t.last_id}'>${e.toUpperCase()}</option>`)}}),$("#form-editar-nota").submit(function(e){e.preventDefault();let t=document.getElementById("nota-id").value,a=this.elements["gd-title"].value,o=this.elements["gd-description"].value,n=(document.getElementById("gd-select-tags"),document.getElementById("gd-get-note")),i=document.getElementById("gd-gategory"),r=document.getElementById("gd-language");var s={note_id:t,note_title:a,note_description:o,note_code:n.innerText,note_category_id:i[i.selectedIndex].value,note_type_language:r[r.selectedIndex].value};return console.log(Note.update(s)),alert("Nota editaca com sucesso!"),!1}),$("#formSave").submit(function(e){e.preventDefault();let t=this,a=this.elements.title.value,o=this.elements.description.value,n=this.elements.code.value,i=this.elements.category[this.elements.category.selectedIndex],r=this.elements["formatacao-language"][this.elements["formatacao-language"].selectedIndex];$("#select-tags").select2("data").map(function(e){});i.value,r.value;var s=new FormData(document.getElementById("formSave"));return fetch(config[INDEX].baseApiRestUrl+"/notes",{method:"POST",body:s}).then(e=>{console.log(e)}),t.reset(),alert("Nota criada com sucesso!"),carregarCategorias(),!1});let e="";$("#sem-notas").removeAttr("hidden"),funcoesNota(),carregarCategorias(),$("#tela-inicial").click(function(){$("#get-notes").html(e),funcoesNota()})});